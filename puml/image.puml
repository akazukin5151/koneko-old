@startuml
title Image Mode

== Mode selection ==
User -> ui ++: Mode 2
ui -> User: Ask for user id
User -> ui: Pixiv id
ui -> api ++: JSON request
return JSON response
create idata
ui -> idata: Stores response
ui -> download: Download images
return Prints info
|||

== Open image ==
User -> ui ++: Open image
return Opened {link}!
|||

== Download image ==
User -> ui ++: Download image
ui -> download: download_image_verified()
return
|||

== Next image ==
User -> ui ++: next_page()
ui -> download: async_download_spinner()
ui --> User: Display image
group Prefetch next image
    ui -> idata ++: next_img_url
    return next_img_url
    ui -> download: async_download_spinner()
    ui -> idata: Update downloaded_images
end
return
|||

== Previous page ==
User -> ui ++: previous_page()
return Print info
|||

@enduml

